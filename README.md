# ERCOT Energy Price Predictor (EEPP)

Python automation to **download, process, and visualize** ERCOT data: solar, wind, system forecast, HROC, MORA, and market prices (DAM/RTM). Outputs styled Excel and PNG charts. Optional Slack notifications.

Licensed under the MIT License. This project uses third-party libraries under their own licenses (see requirements.txt).

## Highlights
- **Automated retrieval** (web + ERCOT API) with Selenium/Requests
- **Data engineering**: merge feeds, compute metrics (net load, outages, reserve margin)
- **Visualization**: supply/demand, thermal reserve margin, DAM vs. RTM (DART)
- **Slack integration** (optional): plots + files posted to a channel
- **Scheduling**:
  - Batch files for **Windows Task Scheduler**
  - Optional Windows Service wrapper (runs daily jobs at fixed times)

---

## Sample Output

Below is an example 7-Day Supply/Demand Forecast with Thermal Reserve Margin (auto-generated by `eepp_phase_1.py`):

![ERCOT Combined Forecast](production/ercot_combined_forecast_2025-05-03_T16_36_29.png)

This chart shows:
- Forecasted demand vs. renewable generation
- Dispatchable supply
- Net load and net thermal capacity
- Thermal reserve margin (bar view)

---

## Machine Setup & Configuration

Follow these steps to configure your machine so the EEPP automation runs smoothly:

### 1. Install Python
- Install **Python 3.10+** from [python.org](https://www.python.org/downloads/).
- During installation, check the option **“Add Python to PATH”**.
- Verify installation:
  ```bash
  python --version
  ```

### 2. Clone Repo & Create Virtual Environment
```bash
git clone https://github.com/jdak907/eepp.git
cd eepp/_script
python -m venv venv
venv\Scripts\activate
pip install -r ../requirements.txt
```

### 3. Slack Bot Setup (Optional but Recommended)
1. Go to [Slack API: Your Apps](https://api.slack.com/apps).
2. Create a **new app** → “From scratch”.
3. Enable **OAuth & Permissions**:
   - Add **chat:write** and **files:write** scopes.
   - Install app to your workspace.
4. Copy your **Bot User OAuth Token**.
5. In your system environment variables, set:
   ```
   SLACK_TOKEN=xoxb-your-slack-bot-token
   ```

### 4. ERCOT API Credentials (Phase 2)
If you want to pull DAM/RTM datasets from ERCOT API:
- Request ERCOT API access.
- Add the following environment variables:
  ```
  ERCOT_API_USERNAME=your_username
  ERCOT_API_PASSWORD=your_password
  ERCOT_API_PRIMARY_KEY=your_primary_key
  ```

### 5. Environment Variables (Windows)
- Press **Win + R** → type `sysdm.cpl` → Advanced → Environment Variables.
- Add new **User Variables** (example):
  - `SLACK_TOKEN`
  - `ERCOT_API_USERNAME`
  - `ERCOT_API_PASSWORD`
  - `ERCOT_API_PRIMARY_KEY`

### 6. Running with Batch Files
- Use `_run_eepp_phase_1.bat` and `_run_eepp_phase_2.bat` to launch scripts.
- Test by double-clicking a `.bat` file.
- Expected output:
  - New PNG and Excel in `/production`
  - (Optional) Slack message with files attached

### 7. Windows Task Scheduler Automation
1. Open **Task Scheduler** → Create Basic Task.
2. Trigger: Daily (e.g., 5:00 AM for Phase 1).
3. Action: **Start a program**.
   - Program/script: `cmd.exe`
   - Arguments: `/c "_run_eepp_phase_1.bat"`
   - Start in: path to your `_script` folder
4. Repeat for `_run_eepp_phase_2.bat` (e.g., 1:05 PM).
5. Confirm by checking **Task Scheduler Library**.

### 8. Windows Service (Optional)
Instead of Task Scheduler, you can run everything as a service:
```bash
python eepp_service.py install
python eepp_service.py start
```
This runs Phase 1 at **05:00** and Phase 2 at **13:05** daily.  
To stop:
```bash
python eepp_service.py stop
```

---

## Repo Layout
```
_project_root/
  icons/
    logo.png            # obfuscated/neutral icon name
  _script/
    eepp_phase_1.py
    eepp_phase_2.py
    eepp_service.py
    _run_eepp_phase_1.bat
    _run_eepp_phase_2.bat
  production/
    archive/
    ercot_combined_forecast_2025-05-03_T16_36_29.png   # example chart
```

> **Note:** The example chart is static. Each run produces new time-stamped PNGs and Excel workbooks in the `production/` folder.
